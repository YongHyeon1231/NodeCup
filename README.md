# NodeCup 
Football-Online server development limit in Insomnia
</br>
## 💻 프로젝트 소개
백엔드로 구현된 가상 풋볼 온라인 서버 게임
</br>
## 🚛 개발 기간
* 24.09.13 - 24.09.24 (연휴 제외)
</br>
## 멤버 구성 </br>
 - 박용현 : 포메이션 카드 장착, 탈착 기능 + 포메이션 조회 </br>
 - 황현권 : 게임플레이, 랭킹 조회 </br>
 - 최성원 : 상점 기능, 이적 시장 기능, 강화 기능, 시즌 기능, MMR 시스템 추가 </br>
 - 김진엽 : club 생성, 조회, 삭제 기능 </br>
 - 윤여빈 : 카드 수정, 카드 생성, 보유하고 있는 카드 조회 </br>
(User 로그인, 회원가입, 인증, 스키마 작성 부분은 다같이 구현) </br>
</br>
### 개발 환경 </br>
 - Node.js v20.16.0. </br>
 - JDK 1.0.0 </br>
 - IDE : VSCODE 1.93.1 </br>
 - Framework : express 4.21.0 </br>
 - Database : MySQL </br>
 - ORM : Prisma 5.19.1 </br>
</br>
## 주요 기능 </br>
 - 회원가입 </br>
 - 로그인 </br>
 - 클럽 생성 </br>
 - 클럽 조회 </br>
 - 클럽 삭제 </br>
 - 캐시 충전 </br>
 - 선수, 감독 카드 생성 (인가) </br>
 - 선수, 감독 카드 수정 (인가) </br>
 - 선수, 감독 카드 구매 </br>
 - 보유중인 카드 목록 조회 </br>
 - 선수 카드 강화 </br>
 - 이적시장 구매 </br>
 - 이적시장 판매 </br>
 - 이적시장 조회 </br>
 - 이적시장 해제 </br>
 - 포메이션 카드 장착 </br>
 - 포메이션 카드 장착 해제 </br>
 - 설정한 포메이션 조회 </br>
 - 게임 플레이 </br>
 - 순위 공개 </br>
 - 시즌 1등 조회 </br>
</br>
## API 명세서  </br>
[API 명세서](https://www.notion.so/9389101369a2433693276532126fdc1b?pvs=21) </br>
</br>
## ERD </br>
![image](https://github.com/user-attachments/assets/338d8b45-8940-449e-a099-f390258c5973) </br>
</br>
## 개발 중 어려웠던 점 + 해결 방법 </br>
 - 박용현 : 포메이션 카드 장착 기능 개발 중 여러 문제에 직면했습니다.</br>
조건문을 충분히 검토하지 않아, totalStat 관리와 카드 장착 시 계산 값이 올바르게 반영되지 않는 오류가 발생했습니다.</br>
또한, 포지션 입력 오류로 인해 장착이 제대로 이루어지지 않았고, 동일한 cardId가 중복으로 장착되는 문제도 있었습니다.</br>
이 문제들을 해결하기 위해 Insomnia를 통해 다양한 API 테스트를 실시하며 오류를 분석하고 조건 검증에 힘을 썼습니다.</br>
마지막으로, Repository Pattern을 학습한 후 Code Refactoring을 진행하여 데이터 접근 로직을 정리하고 가시성을 높였습니다.</br>
 - 황현권 : 게임 플레이 후 저희 팀은 무승부를 생각 해 두지 않았지만 서로의 스코어에서 같은 점수가 나와 동점임에도 불구 하고 어느 한쪽이 그냥 이겨버려 if 문으로 조건을 두어 같은 점수가 나왔을 때 Math.random() 확률로 상대나 자신에게 추가 점수를 주도록 설정했다.</br>
 - 최성원 : 강화 후 카드 번호를 수정하는 과정에서, 트랜잭션 내부에서는 병렬 처리가 제한된다는 사실을 몰랐습니다.</br> 이로 인해 카드 업데이트가 1장씩 동기적으로 처리되어 300장 기준으로 약 8~10초가 소요되었고, 속도가 상당히 느렸습니다.</br> (트랜잭션 내부에서는 데이터 일관성을 유지하기 위해 접근 제어와 동시성 제어가 이루어져 병렬 처리가 일부 제한됩니다.)</br>그러나 이를 트랜잭션 밖으로 빼낸 후 데이터를 병렬 처리하고, await Promise.all로 감싸주니 300장 기준으로 1~2초 정도의 속도로 작업을 처리할 수 있게 되었습니다.</br>
 - 김진엽 : git 사용법이 익숙치 않아서 자꾸 헤맷던거 같습니다, 그래서 주변 지인들의 도움과 튜터님들 덕분에 사용법을 익혔습니다.</br>
 - 윤여빈 : createMany 기능을 처음 이용해봐서 데이터가 배열로 받아져서 각각의 데이터에 접근하는 게 처음에는 어려웠으나, for of 문을 통해 각각의 데이터에 접근하여 중복검사 및 타입에 따른 결과 메시지 반환을 진행할 수 있었다.</br>
